version: '2'
services:
    appvolume:
        build:
            context: .
            dockerfile: hello.dockerfile
        command: sleep infinity
    app:
        build:
            context: .
            dockerfile: app.dockerfile
        command: ["/opt/tomcat/bin/catalina.sh", "run"]
        container_name: app-server
        depends_on: [ "appvolume" ]
        volumes_from: [ "appvolume" ]
    web:
        build:
            context: .
            dockerfile: web.dockerfile
        command: nginx -g 'daemon off;'
        depends_on: [ "app" ]
        external_links: ["app-server:tomcat"]
        expose: [ "80" ]
        ports: [ "80:80" ]
