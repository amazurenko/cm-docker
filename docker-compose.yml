version: '2'
services:
    application:
        build:
            context: .
            dockerfile: application.Dockerfile
        command: sleep infinity
        container_name: "application"
    tomcat:
        build:
            context: .
            dockerfile: tomcat.Dockerfile
        command: ["catalina.sh", "run"]
        container_name: tomcat
        depends_on: 
            - "application"
        volumes_from: 
            - "application"
        expose:
            - "8080"
    nginx:
        build:
            context: .
            dockerfile: web.Dockerfile
        command: [ "nginx", "-g", "daemon off;" ]
        container_name: "nginx"
        depends_on: 
            - "tomcat"
        expose:
            - "80"
        ports:
            - "80:80"
